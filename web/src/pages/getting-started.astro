---
import Layout from '../components/Layout.astro';
import CodeBlock from '../components/CodeBlock.astro';
import InstallTabs from '../components/InstallTabs.astro';

const base = import.meta.env.BASE_URL;
---

<Layout title="Getting Started" description="Step-by-step guide to install and use azd exec extension">
  <div class="page-container">
    <div class="page-header">
      <h1>Getting Started</h1>
      <p class="page-intro">
        Follow these steps to install azd exec and run your first script with Azure context.
      </p>
    </div>

    <div class="content">
      <section class="section">
        <h2>Prerequisites</h2>
        <p>Before installing azd exec, make sure you have:</p>
        <ul>
          <li><strong>Azure Developer CLI (azd)</strong> installed on your system</li>
          <li><strong>Azure subscription</strong> and appropriate permissions</li>
          <li><strong>Basic knowledge</strong> of shell scripting (bash or PowerShell)</li>
        </ul>
        <p>If you don't have azd installed, visit the <a href="https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd" target="_blank" rel="noopener noreferrer">official installation guide</a>.</p>
      </section>

      <section class="section">
        <h2>Installation</h2>
        <p>Install the azd exec extension using the following commands for your platform:</p>
        <InstallTabs />
      </section>

      <section class="section">
        <h2>Verify Installation</h2>
        <p>Confirm that azd exec is installed correctly:</p>
        <CodeBlock code="azd exec version" language="bash" />
        <p>You should see output similar to:</p>
        <CodeBlock code={`azd exec version 0.1.0`} language="text" showCopy={false} />
      </section>

      <section class="section">
        <h2>Run Your First Script</h2>
        <p>Create a simple script to test azd exec:</p>
        
        <h3>For Bash/Linux/macOS</h3>
        <CodeBlock code={`# Create a test script
cat > test-script.sh << 'EOF'
#!/bin/bash
echo "Azure Environment: \$AZURE_ENV_NAME"
echo "Subscription: \$AZURE_SUBSCRIPTION_ID"
echo "Location: \$AZURE_LOCATION"
EOF

# Make it executable
chmod +x test-script.sh

# Review the script
cat test-script.sh

# Execute with azd exec
azd exec ./test-script.sh`} language="bash" />

        <h3>For PowerShell/Windows</h3>
        <CodeBlock code={`# Create a test script
@'
Write-Host "Azure Environment: \$env:AZURE_ENV_NAME"
Write-Host "Subscription: \$env:AZURE_SUBSCRIPTION_ID"
Write-Host "Location: \$env:AZURE_LOCATION"
'@ | Out-File test-script.ps1

# Review the script
Get-Content test-script.ps1

# Execute with azd exec
azd exec ./test-script.ps1`} language="powershell" />
      </section>

      <section class="section">
        <h2>Security Best Practices</h2>
        <div class="alert-warning">
          <strong>‚ö†Ô∏è Important:</strong> azd exec runs scripts with full access to your Azure credentials and environment variables.
        </div>
        
        <h3>Always Follow These Practices:</h3>
        <ul class="checklist">
          <li>‚úÖ Review scripts before running them</li>
          <li>‚úÖ Use HTTPS for any script downloads</li>
          <li>‚úÖ Verify the source of scripts from documentation or trusted repositories</li>
          <li>‚úÖ Store secrets in Azure Key Vault, not environment variables</li>
          <li>‚ùå Never pipe untrusted scripts: <code>curl http://site.com/script.sh | azd exec -</code></li>
          <li>‚ùå Don't run scripts from unknown or untrusted sources</li>
        </ul>

        <p>For comprehensive security information, see the <a href={`${base}security`}>Security Guidelines</a>.</p>
      </section>

      <section class="section">
        <h2>Common Commands</h2>
        
        <h3>Basic Execution</h3>
        <CodeBlock code="azd exec ./my-script.sh" language="bash" />

        <h3>Pass Arguments</h3>
        <CodeBlock code="azd exec ./build.sh -- --verbose --config release" language="bash" />

        <h3>Specify Shell</h3>
        <CodeBlock code="azd exec ./deploy.ps1 --shell pwsh" language="bash" />

        <h3>Set Working Directory</h3>
        <CodeBlock code="azd exec ./setup.sh --cwd /path/to/project" language="bash" />

        <h3>Interactive Mode</h3>
        <CodeBlock code="azd exec ./interactive-setup.sh --interactive" language="bash" />
      </section>

      <section class="section">
        <h2>Next Steps</h2>
        <div class="next-steps">
          <div class="next-step-card">
            <h3>üìö Explore Examples</h3>
            <p>See real-world usage examples for different scenarios.</p>
            <a href={`${base}examples`} class="card-link">View Examples ‚Üí</a>
          </div>

          <div class="next-step-card">
            <h3>üìñ CLI Reference</h3>
            <p>Learn about all available commands and options.</p>
            <a href={`${base}reference/cli/`} class="card-link">Read Documentation ‚Üí</a>
          </div>

          <div class="next-step-card">
            <h3>üîí Security Guide</h3>
            <p>Understand security implications and best practices.</p>
            <a href={`${base}security`} class="card-link">Read Security Guide ‚Üí</a>
          </div>
        </div>
      </section>
    </div>
  </div>
</Layout>

<style>
  .page-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 3rem 1.5rem;
  }

  .page-header {
    margin-bottom: 3rem;
  }

  .page-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 1rem;
    color: var(--color-text-primary);
  }

  .page-intro {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    margin: 0;
  }

  .content {
    line-height: 1.7;
  }

  .section {
    margin-bottom: 3rem;
  }

  .section h2 {
    font-size: 1.75rem;
    font-weight: 600;
    margin: 0 0 1rem;
    color: var(--color-text-primary);
  }

  .section h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 2rem 0 1rem;
    color: var(--color-text-primary);
  }

  .section p {
    margin: 0 0 1rem;
    color: var(--color-text-secondary);
  }

  .section ul {
    margin: 0 0 1rem;
    padding-left: 1.5rem;
  }

  .section li {
    margin: 0.5rem 0;
    color: var(--color-text-secondary);
  }

  .checklist {
    list-style: none;
    padding-left: 0;
  }

  .checklist li {
    padding-left: 1.5rem;
    position: relative;
  }

  .alert-warning {
    background-color: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    color: #664d03;
  }

  [data-theme="dark"] .alert-warning {
    background-color: #664d03;
    border-color: #997404;
    color: #ffeaa7;
  }

  .next-steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
  }

  .next-step-card {
    border: 1px solid var(--color-border-default);
    border-radius: 0.5rem;
    padding: 1.5rem;
    background-color: var(--color-bg-primary);
  }

  .next-step-card h3 {
    font-size: 1.125rem;
    margin: 0 0 0.5rem;
    color: var(--color-text-primary);
  }

  .next-step-card p {
    margin: 0 0 1rem;
    font-size: 0.875rem;
  }

  .card-link {
    color: var(--color-interactive-default);
    font-weight: 600;
    text-decoration: none;
  }

  .card-link:hover {
    text-decoration: underline;
  }
</style>
